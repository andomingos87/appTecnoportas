!function(s,a,e){"use strict";function t(){}var i=s("body"),g=s(a),w=s(e);function M(e,i,t,n){return e/=n,-t*(--e*e*e*e-1)+i}for(var r=0,n=["ms","moz","webkit","o"],o=0;o<n.length&&!a.requestAnimationFrame;++o)a.requestAnimationFrame=a[n[o]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[n[o]+"CancelAnimationFrame"]||a[n[o]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(e,i){var t=(new Date).getTime(),n=Math.max(0,16-(t-r)),o=a.setTimeout(function(){e(t+n)},n);return r=t+n,o}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(e){clearTimeout(e)});var h='<div class="iv-loader"></div> <div class="iv-snap-view"><div class="iv-snap-image-wrap"><div class="iv-snap-handle"></div></div><div class="iv-zoom-slider"><div class="iv-zoom-handle"></div></div></div><div class="iv-image-view" ><div class="iv-image-wrap" ></div></div>';function z(e,i){this.container=e,this.onStart=i.onStart||t,this.onMove=i.onMove||t,this.onEnd=i.onEnd||t,this.sliderId=i.sliderId||"slider"+Math.ceil(1e6*Math.random())}function m(e,i){var t=this;e.is("#iv-container")&&(t._fullPage=!0),t.container=e,i=t.options=s.extend({},m.defaults,i),t.zoomValue=100,e.find(".snap-view").length||e.prepend(h),e.addClass("iv-container"),"static"==e.css("position")&&e.css("position","relative"),t.snapView=e.find(".iv-snap-view"),t.snapImageWrap=e.find(".iv-snap-image-wrap"),t.imageWrap=e.find(".iv-image-wrap"),t.snapHandle=e.find(".iv-snap-handle"),t.zoomHandle=e.find(".iv-zoom-handle"),t._viewerId="iv"+Math.floor(1e6*Math.random())}s(function(){(i=i.length?i:s("body")).append('<div id="iv-container">'+h+'<div class="iv-close"></div><div>')}),z.prototype.init=function(){var h=this,m=(this.container,"."+this.sliderId);return this.container.on("touchstart"+m+" mousedown"+m,function(e){e.preventDefault();var i,t,n=("touchstart"==e.type?"touchmove":"mousemove")+m,o=("touchstart"==e.type?"touchend":"mouseup")+m,a=e.originalEvent,s=a.clientX||a.touches[0].clientX,r=a.clientY||a.touches[0].clientY;!1!==h.onStart(e,{x:s,y:r})&&(t=function(){w.off(n,i),w.off(o,t),h.onEnd()},w.on(n,i=function(e){e.preventDefault();var i=(a=e.originalEvent).clientX||a.touches[0].clientX,t=a.clientY||a.touches[0].clientY;h.onMove(e,{dx:i-s,dy:t-r,mx:i,my:t})}),w.on(o,t))}),this},m.prototype={constructor:m,_init:function(){var i,t,n,h=this,o=h.options,m=!1,c=this.container,e="."+h._viewerId,s=this.snapHandle,a=this.snapImageWrap,r=this.imageWrap,l=new z(a,{sliderId:h._viewerId,onStart:function(){if(!h.loaded)return!1;var e=s[0].style;this.curHandleTop=parseFloat(e.top),this.curHandleLeft=parseFloat(e.left),this.handleWidth=parseFloat(e.width),this.handleHeight=parseFloat(e.height),this.width=a.width(),this.height=a.height(),clearInterval(d.slideMomentumCheck),cancelAnimationFrame(d.sliderMomentumFrame)},onMove:function(e,i){var t=this.curHandleLeft+100*i.dx/this.width,i=this.curHandleTop+100*i.dy/this.height,t=Math.max(0,t),i=(t=Math.min(100-this.handleWidth,t),i=Math.max(0,i),Math.min(100-this.handleHeight,i)),n=h.containerDim,o=h.imageDim.w*(h.zoomValue/100),a=h.imageDim.h*(h.zoomValue/100),o=o<n.w?(n.w-o)/2:-o*t/100,n=a<n.h?(n.h-a)/2:-a*i/100;s.css({top:i+"%",left:t+"%"}),h.currentImg.css({left:o,top:n})}}).init(),d=h._imageSlider=new z(r,{sliderId:h._viewerId,onStart:function(e,i){if(!h.loaded)return!1;var t;m||(t=this,l.onStart(),t.imgWidth=h.imageDim.w*h.zoomValue/100,t.imgHeight=h.imageDim.h*h.zoomValue/100,t.positions=[i,i],t.startPosition=i,h._clearFrames(),t.slideMomentumCheck=setInterval(function(){t.currentPos&&(t.positions.shift(),t.positions.push({x:t.currentPos.mx,y:t.currentPos.my}))},50))},onMove:function(e,i){m||(this.currentPos=i,l.onMove(e,{dx:-i.dx*l.width/this.imgWidth,dy:-i.dy*l.height/this.imgHeight}))},onEnd:function(){var i,t,n,o,a,s;m||(t=(i=this).positions[1].x-this.positions[0].x,n=this.positions[1].y-this.positions[0].y,(30<Math.abs(t)||30<Math.abs(n))&&(o=1,a=i.currentPos.dx,s=i.currentPos.dy,function e(){o<=60&&(i.sliderMomentumFrame=requestAnimationFrame(e)),a+=M(o,t/3,-t/3,60),s+=M(o,n/3,-n/3,60),l.onMove(null,{dx:-(a*l.width/i.imgWidth),dy:-(s*l.height/i.imgHeight)}),o++}()))}}).init(),u=0,p=(r.on("mousewheel"+e+" DOMMouseScroll"+e,function(e){var i,t,n;o.zoomOnMouseWheel&&h.loaded&&(h._clearFrames(),t=Math.max(-1,Math.min(1,e.originalEvent.wheelDelta||-e.originalEvent.detail)),100<=(i=h.zoomValue*(100+15*t)/100)&&i<=o.maxZoom?u=0:u+=Math.abs(t),5<u||(e.preventDefault(),t=c.offset(),n=(e.pageX||e.originalEvent.pageX)-t.left,e=(e.pageY||e.originalEvent.pageY)-t.top,h.zoom(i,{x:n,y:e}),v()))}),r.on("touchstart"+e,function(e){var i,t,n,o,a,s,r;h.loaded&&(i=e.originalEvent.touches[0],e=e.originalEvent.touches[1],i&&e&&(m=!0,t=c.offset(),n=Math.sqrt(Math.pow(e.pageX-i.pageX,2)+Math.pow(e.pageY-i.pageY,2)),o=h.zoomValue,a={x:(e.pageX+i.pageX)/2-t.left,y:(e.pageY+i.pageY)/2-t.top},r=function(){w.off("touchmove",s),w.off("touchend",r),m=!1},w.on("touchmove",s=function(e){e.preventDefault();var i=e.originalEvent.touches[0],e=e.originalEvent.touches[1],e=Math.sqrt(Math.pow(e.pageX-i.pageX,2)+Math.pow(e.pageY-i.pageY,2));h.zoom(o+(e-n)/2,a)}),w.on("touchend",r)))}),0),f=(r.on("click"+e,function(e){0==p?(p=Date.now(),i={x:e.pageX,y:e.pageY}):p=(Date.now()-p<500&&Math.abs(e.pageX-i.x)<50&&Math.abs(e.pageY-i.y)<50&&(h.zoomValue==o.zoomValue?h.zoom(200):h.resetZoom()),0)}),h.snapView.find(".iv-zoom-slider"));new z(f,{sliderId:h._viewerId,onStart:function(e){if(!h.loaded)return!1;this.leftOffset=f.offset().left,this.handleWidth=h.zoomHandle.width(),this.onMove(e)},onMove:function(e,i){e=(e.pageX||e.originalEvent.touches[0].pageX)-this.leftOffset-this.handleWidth/2,e=Math.max(0,e),e=Math.min(h._zoomSliderLength,e),e=100+(o.maxZoom-100)*e/h._zoomSliderLength;h.zoom(e)}}).init();function v(e){!o.snapView||n||h.zoomValue<=100||!h.loaded||(clearTimeout(t),n=!0,h.snapView.css("opacity",1),e||(t=setTimeout(function(){h.snapView.css("opacity",0),n=!1},4e3)))}r.on("touchmove"+e+" mousemove"+e,function(){v()});r={};r["mouseenter"+e+" touchstart"+e]=function(){v(!(n=!1))},r["mouseleave"+e+" touchend"+e]=function(){n=!1,v()},h.snapView.on(r),o.refreshOnResize&&g.on("resize"+e,function(){h.refresh()}),h._fullPage&&(c.on("touchmove"+e+" mousewheel"+e+" DOMMouseScroll"+e,function(e){e.preventDefault()}),c.find(".iv-close").on("click"+e,function(){h.hide()}))},zoom:function(s,r){s=Math.round(Math.max(100,s)),s=Math.min(this.options.maxZoom,s),r=r||{x:this.containerDim.w/2,y:this.containerDim.h/2};var h=this,m=this.options.maxZoom,c=this.zoomValue,l=this.currentImg,d=(this.containerDim,parseFloat(l.css("left"))),u=parseFloat(l.css("top")),p=(h._clearFrames(),0),e=h.containerDim,i=h.imageDim,f=(e.w-i.w)/2,v=(e.h-i.h)/2,g=e.w-f,w=e.h-v;!function e(){++p<20&&(h._zoomFrame=requestAnimationFrame(e));var i=M(p,c,s-c,20),t=i/c,n=h.imageDim.w*i/100,o=h.imageDim.h*i/100,a=-((r.x-d)*t-r.x),t=-((r.y-u)*t-r.y),a=Math.min(a,f),t=Math.min(t,v);l.css({height:o+"px",width:n+"px",left:(a=a+n<g?g-n:a)+"px",top:(t=t+o<w?w-o:t)+"px"}),h.zoomValue=i,h._resizeHandle(n,o,a,t),h.zoomHandle.css("left",(i-100)*h._zoomSliderLength/(m-100)+"px")}()},_clearFrames:function(){clearInterval(this._imageSlider.slideMomentumCheck),cancelAnimationFrame(this._imageSlider.sliderMomentumFrame),cancelAnimationFrame(this._zoomFrame)},resetZoom:function(){this.zoom(this.options.zoomValue)},_calculateDimensions:function(){var e=this,i=e.currentImg,t=e.container,n=e.snapView,o=i.width(),a=i.height(),s=t.width(),t=t.height(),r=n.innerWidth(),n=n.innerHeight();e.containerDim={w:s,h:t};var h=o/a,a=a<o&&s<=t||s<h*t?s:h*t,o=a/h,h=(e.imageDim={w:a,h:o},i.css({width:a+"px",height:o+"px",left:(s-a)/2+"px",top:(t-o)/2+"px","max-width":"none","max-height":"none"}),o<a?r:a*n/o),i=a<o?n:o*r/a;e.snapImageDim={w:h,h:i},e.snapImg.css({width:h,height:i}),e._zoomSliderLength=r-e.zoomHandle.outerWidth()},refresh:function(){this.loaded&&(this._calculateDimensions(),this.resetZoom())},_resizeHandle:function(e,i,t,n){var o=this.currentImg,e=e||this.imageDim.w*this.zoomValue/100,i=i||this.imageDim.h*this.zoomValue/100,t=Math.max(100*-(t||parseFloat(o.css("left")))/e,0),n=Math.max(100*-(n||parseFloat(o.css("top")))/i,0),o=Math.min(100*this.containerDim.w/e,100),e=Math.min(100*this.containerDim.h/i,100);this.snapHandle.css({top:n+"%",left:t+"%",width:o+"%",height:e+"%"})},show:function(e,i){this._fullPage&&(this.container.show(),e&&this.load(e,i))},hide:function(){this._fullPage&&this.container.hide()},options:function(e,i){if(!i)return this.options[e];this.options[e]=i},destroy:function(e,i){var t="."+this._viewerId;return this._fullPage?(container.off(t),container.find('[class^="iv"]').off(t)):this.container.remove('[class^="iv"]'),g.off(t),null},load:function(e,i){var t=this,n=this.container;n.find(".iv-snap-image,.iv-large-image").remove();this.container.find(".iv-snap-image-wrap").prepend('<img class="iv-snap-image" src="'+e+'" />'),this.imageWrap.prepend('<img class="iv-large-image" src="'+e+'" />'),i&&this.imageWrap.append('<img class="iv-large-image" src="'+i+'" />');var o=this.currentImg=this.container.find(".iv-large-image");function a(){t.loaded=!0,t.zoomValue=100,o.show(),t.snapImg.show(),t.refresh(),t.resetZoom(),n.find(".iv-loader").hide()}this.snapImg=this.container.find(".iv-snap-image"),t.loaded=!1,n.find(".iv-loader").show(),o.hide(),t.snapImg.hide(),!(e=o[0]).complete||void 0!==e.naturalWidth&&0===e.naturalWidth?s(o[0]).on("load",a):a()}},m.defaults={zoomValue:100,snapView:!0,maxZoom:500,refreshOnResize:!0,zoomOnMouseWheel:!0},a.ImageViewer=function(e,i){e&&("string"==typeof e||e instanceof Element||e[0]instanceof Element)||(i=e,e=s("#iv-container")),(e=s(e)).is("img")?(t=(o=e)[0].src,n=o.attr("high-res-src")||o.attr("data-high-res-src"),e=o.wrap('<div class="iv-container" style="display:inline-block; overflow:hidden"></div>').parent(),o.css({opacity:0,position:"relative",zIndex:-1})):(t=e.attr("src")||e.attr("data-src"),n=e.attr("high-res-src")||e.attr("data-high-res-src"));var t,n,o=new m(e,i);return o._init(),t&&o.load(t,n),o},s.fn.ImageViewer=function(t){return this.each(function(){var e=s(this),i=a.ImageViewer(e,t);e.data("ImageViewer",i)})}}(window.jQuery,window,document);
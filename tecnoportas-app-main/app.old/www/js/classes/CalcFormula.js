function CalcFormula(formula,variaveis){var self=this,Formula=formula,resultado,ops={"+":["MAIS"],"-":["MENOS"],"*":["X","VEZES"],"/":["DIVIDIDO"],"==":["IGUAL"],"!=":["<>","DIFERENTE"],">":["MAIOR"],"<":["MENOR"],">=":["MAIORIGUAL"],"<=":["MENORIGUAL"],"&&":["E"],"||":["OU"]},subVars=function(){for(var a in variaveis){var r=new RegExp(a,"gi");Formula=Formula.replace(r,variaveis[a])}},subOps=function(){for(var a in ops)for(var r=0;r<ops[a].length;r++){var o=new RegExp(ops[a][r],"gi");Formula=Formula.replace(o,a)}},checaFormula=function(){return!/^[^0-9.+*/&|!=><-]+$/.test(Formula)};self.calcula=function(){return subVars(),subOps(),checaFormula()?(Formula="resultado = "+Formula+";",eval(Formula),resultado):"Erro: Caracteres invÃ¡lidos encontrados!"}}